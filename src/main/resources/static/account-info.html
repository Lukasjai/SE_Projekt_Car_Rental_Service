<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Account Information</title>
</head>
<body>
<h1>Account Information</h1>

<!-- Logout Button -->
<form id="logoutForm" method="post" action="/customers/logout">
    <button type="submit">Logout</button>
</form>

<!-- Past Bookings -->
<h2>Past Bookings</h2>
<div class="booking">
    <p>Date: January 1, 2024</p>
    <p>Car: Model A (Brand A)</p>
    <p>Cost: $50</p>
</div>
<div class="booking">
    <p>Date: February 15, 2024</p>
    <p>Car: Model B (Brand B)</p>
    <p>Cost: $60</p>
</div>

<!-- Current Bookings -->
<h2>Current Bookings</h2>
<div class="booking">
    <p>Date: April 5, 2024</p>
    <p>Car: Model C (Brand C)</p>
    <p>Cost: $70</p>
</div>

<!-- Account Settings Form -->
<h2>Account Settings</h2>
<form id="accountSettingsForm">
    <label for="name">Name:</label>
    <input type="text" id="name" name="name" value="John Doe" required>
    <label for="email">Email:</label>
    <input type="email" id="email" name="email" value="john@example.com" required>
    <label for="password">Password:</label>
    <input type="password" id="password" name="password" required>
    <button type="submit">Save Changes</button>
</form>

<!-- Script to handle form submission -->
<script>
    // Function to update account information
    function updateAccountInfo(email, name, password) {
        // Construct request body
        const requestBody = {
            email: email,
            name: name,
            password: password
        };

        // Send PATCH request to update account info
        fetch('/customers/update', {
            method: 'PATCH',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(requestBody)
        })
            .then(response => {
                if (response.ok) {
                    alert('Account information updated successfully!');
                } else {
                    throw new Error('Failed to update account information');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('An error occurred while updating account information. Please try again later.');
            });
    }

    // Form submission handler
    document.getElementById('accountSettingsForm').addEventListener('submit', function(event) {
        event.preventDefault(); // Prevent default form submission

        // Retrieve form values
        const name = document.getElementById('name').value;
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;

        // Update account information
        updateAccountInfo(email, name, password);
    });

    // Logout form submission
    document.getElementById('logoutForm').addEventListener('submit', function(event) {
        event.preventDefault(); // Prevent default form submission

        // Perform logout action
        fetch('/customers/logout', {
            method: 'POST'
        })
            .then(response => {
                if (response.ok) {
                    // Redirect to login page or perform other actions after logout
                    window.location.href = '/login.html'; // Redirect to login page
                } else {
                    console.error('Logout failed');
                    // Handle logout failure
                }
            })
            .catch(error => {
                console.error('Error:', error);
                // Handle error
            });
    });
</script>
</body>
</html>
